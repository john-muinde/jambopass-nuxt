import{_ as ge}from"./CJVy092J.js";import{_ as _e}from"./CL5d_aLz.js";import{_ as ve}from"./A7ReKu79.js";import{e as be,n as fe,u as le,f as M,g as q,h as ye,i as ke,j as Ce,r as ie,k as Se,l as Fe,o as m,c as h,a as e,b as w,w as L,d as P,t as $,m as c,F as A,p as N,q as re,s as we,v as Le,x as $e,y as ne}from"./CdPH6FqQ.js";import{a as ce}from"./C6-auSY3.js";import{u as de,a as Pe}from"./CueYo5H4.js";import{u as xe}from"./DVz3c7mJ.js";import{u as Be}from"./Dy88yXLX.js";const Oe=be("products",{state:()=>({isFilterLoading:!1,checkedCategories:{},checkedBrands:{},selectedSortOption:"",currentPage:1,perPage:12,trackApiCalls:0}),actions:{setIsFilterLoading(t){this.$patch(a=>{a.isFilterLoading=t})},setCheckedCategories(t){this.$patch(a=>{a.checkedCategories={...t}})},async addCategoryFilter(t,a){this.$patch(l=>{l.checkedCategories[t]||(l.checkedCategories[t]=[]),l.checkedCategories[t].includes(a)||(l.checkedCategories[t]=[...l.checkedCategories[t],a])})},async removeCategoryFilter(t,a){this.$patch(l=>{l.checkedCategories[t]&&(l.checkedCategories[t]=l.checkedCategories[t].filter(y=>y!==a))})},setCheckedBrands(t){this.$patch(a=>{a.checkedBrands={...t}})},async addBrandFilter(t,a){this.$patch(l=>{l.checkedBrands[t]||(l.checkedBrands[t]=[]),l.checkedBrands[t].includes(a)||(l.checkedBrands[t]=[...l.checkedBrands[t],a])})},async removeBrandFilter(t,a){this.$patch(l=>{l.checkedBrands[t]&&(l.checkedBrands[t]=l.checkedBrands[t].filter(y=>y!==a))})},setSortOption(t){this.$patch(a=>{a.selectedSortOption=t})},setCurrentPage(t){this.$patch(a=>{a.currentPage=t})},incrementApiCalls(){this.$patch(t=>{t.trackApiCalls++})},resetFilters(){this.$patch(t=>{t.checkedCategories={},t.checkedBrands={},t.selectedSortOption="",t.currentPage=1})},async applyFilters(t,a,l){if(!this.isFilterLoading){this.setIsFilterLoading(!0);try{await Promise.all([this.setCurrentPage(1),a.push(l("page=1"))]),this.incrementApiCalls()}catch(y){console.error("Error applying filters:",y)}finally{await fe(),this.setIsFilterLoading(!1)}}}},getters:{getFilters:t=>({...t,checkedCategories:t.checkedCategories,checkedBrands:t.checkedBrands}),hasActiveFilters:t=>{const a=Object.values(t.checkedCategories).some(y=>y.length>0),l=Object.values(t.checkedBrands).some(y=>y.length>0);return a||l||!!t.selectedSortOption},getActiveCategoryFilters:t=>a=>[...t.checkedCategories[a]||[]],getActiveBrandFilters:t=>a=>[...t.checkedBrands[a]||[]],getCurrentPageFilters:t=>({page:t.currentPage,perPage:t.perPage})}}),Ae=(t,a)=>{const l=le(),{generateSeoMeta:y,generateHeadInput:Z,generateContentMetaTags:G,config:S}=de(),E=()=>{var v,u,d,n;const g=(u=(v=t.value)==null?void 0:v.brands)==null?void 0:u.map(_=>{var b;return(b=_.product_brand)==null?void 0:b.name}).filter(Boolean).slice(0,3).join(", "),p=(n=(d=t.value)==null?void 0:d.theCategory)==null?void 0:n.name,k=a==null?void 0:a.name;return`Explore our selection of ${p} products in the ${k} category. 
            Browse top brands like ${g} and more. 
            Professional ${k.toLowerCase()} solutions by Sheffield Steel Systems in East Africa.`},j=M(()=>{var g,p,k,v,u,d,n,_,b,x,I;return G({type:"productList",content:{name:`${(p=(g=t.value)==null?void 0:g.theCategory)==null?void 0:p.name} - ${a==null?void 0:a.name} Products`,description:E(),keywords:`${a==null?void 0:a.keywords}, 
                  ${(v=(k=t.value)==null?void 0:k.theCategory)==null?void 0:v.name}, 
                  ${(d=(u=t.value)==null?void 0:u.brands)==null?void 0:d.map(z=>{var V;return(V=z.product_brand)==null?void 0:V.name}).join(", ")},
                  ${(_=(n=t.value)==null?void 0:n.products)==null?void 0:_.map(z=>z.name).join(", ")}`,main_image_path:(I=(x=(b=t.value)==null?void 0:b.products)==null?void 0:x[0])==null?void 0:I.main_image_path}})}),T=M(()=>{var g,p,k,v,u;return{"@context":"https://schema.org","@type":"ItemList",name:`${(p=(g=t.value)==null?void 0:g.theCategory)==null?void 0:p.name} Products by Sheffield Steel Systems`,description:E(),numberOfItems:((k=t.value)==null?void 0:k.total)||0,itemListElement:((u=(v=t.value)==null?void 0:v.products)==null?void 0:u.map((d,n)=>{var _,b,x;return{"@type":"ListItem",position:n+1,item:{"@type":"Product",name:d.name,image:ce(d.main_image_path),url:q(d),brand:{"@type":"Brand",name:((_=d.product_brand)==null?void 0:_.name)||"Sheffield Steel Systems"},category:(x=(b=t.value)==null?void 0:b.theCategory)==null?void 0:x.name,description:d.description||`Professional ${d.name} by Sheffield Steel Systems`,manufacturer:{"@type":"Organization",name:"Sheffield Steel Systems","@id":"https://sheffieldafrica.com/#organization"},offers:{"@type":"Offer",availability:"https://schema.org/InStock",seller:{"@type":"Organization",name:"Sheffield Steel Systems","@id":"https://sheffieldafrica.com/#organization"}}}}}))||[]}}),R=M(()=>{var g,p;return{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,item:{"@id":S.url,name:"Home"}},{"@type":"ListItem",position:2,item:{"@id":`${S.url}/${a==null?void 0:a.slug}`,name:a==null?void 0:a.name}},{"@type":"ListItem",position:3,item:{"@id":S.url+l.fullPath,name:(p=(g=t.value)==null?void 0:g.theCategory)==null?void 0:p.name}}]}}),r=M(()=>{var g,p,k,v,u,d;return{"@context":"https://schema.org","@type":"FilterList",name:`Filters for ${(p=(g=t.value)==null?void 0:g.theCategory)==null?void 0:p.name}`,itemListElement:[{"@type":"FilterSection",name:"Categories",filterOptions:(v=(k=t.value)==null?void 0:k.categories)==null?void 0:v.map(n=>({"@type":"FilterOption",name:n.name,value:n.id}))},{"@type":"FilterSection",name:"Brands",filterOptions:(d=(u=t.value)==null?void 0:u.brands)==null?void 0:d.map(n=>{var _,b;return{"@type":"FilterOption",name:(_=n.product_brand)==null?void 0:_.name,value:(b=n.product_brand)==null?void 0:b.id}})}]}});return{metaTags:j,productListSchema:T,breadcrumbSchema:R,filterSchema:r}},Te={class:"main"},Ne={"aria-label":"breadcrumb",class:"breadcrumb-nav border-0 mb-0"},Me={class:"container d-flex align-items-center"},Ee={class:"breadcrumb"},je={class:"breadcrumb-item"},ze={class:"breadcrumb-item"},He={class:"breadcrumb-item active","aria-current":"page"},Ie={class:"page-content"},Ve={class:"container"},qe={key:0,class:"products mb-3 products-section"},Re={class:"row"},Ue={key:1,class:"error-content"},Ze={class:"error-actions"},Ge={key:2,class:"row"},We={class:"col-lg-10"},Je={class:"toolbox"},Ke={class:"toolbox-left"},Qe={class:"toolbox-info"},Xe={class:"toolbox-right"},Ye={class:"toolbox-sort"},De={class:"select-custom"},et={class:"products mb-3 products-section"},tt={class:"row"},st={class:"product product-7 text-center"},at={class:"product-media"},ot={class:"product-action"},it=["onClick"],rt={class:"product-body"},nt={class:"product-cat"},lt={class:"product-title"},ct={"aria-label":"Page navigation"},dt={class:"pagination justify-content-center"},ut=["innerHTML"],mt={class:"col-lg-2 order-lg-first"},ht={class:"sidebar sidebar-shop sidebar-shop-category"},pt={key:0,class:"widget widget-collapsible"},gt={id:"widget-1",class:"show"},_t={class:"widget-body"},vt={class:"filter-items filter-items-count"},bt={class:"custom-control custom-checkbox"},ft=["id","checked","value","disabled","onChange"],yt=["for"],kt={class:"item-count"},Ct={key:1,class:"count-shimmer shimmer"},St={class:"widget widget-collapsible"},Ft={id:"widget-4",class:"show"},wt={class:"widget-body"},Lt={class:"filter-items"},$t={class:"custom-control custom-checkbox"},Pt=["id","checked","value","onChange"],xt=["for"],Bt={class:"products mb-3 products-section"},Ot={class:"row"},Vt=ye({__name:"[...slug]",async setup(t){let a,l;const{generateSeoMeta:y,generateHeadInput:Z,generateContentMetaTags:G}=de(),S=le(),E=ke(),{segment:j,id:T}=S.params,{api:R}=Ce(),r=Oe(),g=Array.isArray(S.params.slug)?S.params.slug:[S.params.slug],[p,,k]=g,v=ie(!1),u=ie(T?parseInt(T):1),d=M(()=>Se(j));M(()=>r.isFilterLoading);const{data:n,refresh:_,error:b,status:x}=([a,l]=Fe(async()=>xe(`products-${u.value}-${r.currentPage}`,async()=>{const i=await R.get("/api/get-products",{params:{category_id:u.value,page:r.currentPage,per_page:r.perPage,checkedCategories:r.checkedCategories,checkedBrands:r.checkedBrands,selectedSortOption:r.selectedSortOption}});return v.value=!0,{products:i.data.products.data,total:i.data.products.total,perPage:i.data.products.per_page,categories:i.data.categories,brands:i.data.brands,theCategory:i.data.the_category,totalPages:i.data.products.last_page,next_page_url:i.data.products.next_page_url,prev_page_url:i.data.products.prev_page_url,links:i.data.products.links}},{server:!0,immediate:!0})),a=await a,l(),a),{metaTags:I,productListSchema:z,breadcrumbSchema:V,filterSchema:ue}=Ae(n,d.value),H=i=>{const s=i==null?void 0:i.split("page=")[1];return i?`/${j}/${T}/${p}/page/${s}`:`/${j}/${T}/${p}`};Be(()=>{var i,s,f,B,C;return{...Z(S,[z.value,V.value,ue.value]),title:(s=(i=n.value)==null?void 0:i.theCategory)!=null&&s.name?`${n.value.theCategory.name} - ${(f=d.value)==null?void 0:f.name} Products`:"Products",link:[...(B=n.value)!=null&&B.prev_page_url?[{rel:"prev",href:H(n.value.prev_page_url)}]:[],...(C=n.value)!=null&&C.next_page_url?[{rel:"next",href:H(n.value.next_page_url)}]:[]]}}),Pe(y(I.value,S));const W=async(i,s)=>{var f,B;if((B=(f=n.value)==null?void 0:f.theCategory)!=null&&B.id){r.setIsFilterLoading(!0),console.log("Filtering",i,s,"filtering started",r.isFilterLoading);try{const C=n.value.theCategory.id;i==="category"?r.getActiveCategoryFilters(C).includes(s)?r.removeCategoryFilter(C,s):r.addCategoryFilter(C,s):r.getActiveBrandFilters(C).includes(s)?r.removeBrandFilter(C,s):r.addBrandFilter(C,s),await r.applyFilters(C,E,H),await _()}finally{r.setIsFilterLoading(!1)}}},me=i=>W("category",i),he=i=>W("brand",i),pe=async()=>{r.setIsFilterLoading(!0);try{r.resetFilters(),await r.applyFilters(u.value,E,H),await _()}finally{r.setIsFilterLoading(!1)}};return(i,s)=>{var J,K,Q;const f=ge,B=_e,C=ve;return m(),h("main",Te,[e("nav",Ne,[e("div",Me,[e("ol",Ee,[e("li",je,[w(f,{to:"/"},{default:L(()=>s[2]||(s[2]=[P("HOME")])),_:1})]),e("li",ze,[w(f,{to:`/${(J=d.value)==null?void 0:J.slug}`},{default:L(()=>{var O;return[P($((O=d.value)==null?void 0:O.name.toUpperCase()),1)]}),_:1},8,["to"])]),e("li",He,$((Q=(K=c(n))==null?void 0:K.theCategory)==null?void 0:Q.name),1)])])]),e("div",Ie,[e("div",Ve,[w(C,null,{default:L(()=>{var O,X,Y,D,ee,te,se,ae;return[c(x)=="pending"&&!c(r).isFilterLoading?(m(),h("div",qe,[e("div",Re,[(m(),h(A,null,N(12,o=>e("div",{key:o,class:"col-6 col-md-3 col-lg-2 col-xl-2"},s[3]||(s[3]=[e("div",{class:"product product-7 text-center"},[e("div",{class:"product-media shimmer"},[e("div",{class:"product-image-shimmer"})]),e("div",{class:"product-body"},[e("div",{class:"product-cat"},[e("div",{class:"shimmer brand-shimmer"})]),e("div",{class:"product-title"},[e("div",{class:"shimmer title-shimmer"})])])],-1)]))),64))])])):re("",!0),c(b)||!((O=d.value)!=null&&O.active)?(m(),h("div",Ue,[s[5]||(s[5]=e("i",{class:"icon-exclamation-circle text-danger mb-4",style:{"font-size":"3rem"}},null,-1)),s[6]||(s[6]=e("h2",{class:"error-title mb-3"},"No Products Found",-1)),s[7]||(s[7]=e("p",{class:"error-message text-muted mb-4"}," We couldn't find any products in this category. This might be because: ",-1)),s[8]||(s[8]=e("ul",{class:"error-reasons text-left mb-4 mx-auto",style:{"max-width":"400px"}},[e("li",null,"The selected filters might be too restrictive"),e("li",null,"The category might be temporarily empty"),e("li",null,"New products might be coming soon")],-1)),e("div",Ze,[e("button",{class:"btn btn-primary me-3",onClick:s[0]||(s[0]=()=>c(_)())}," Try Again "),w(f,{to:"/",class:"btn btn-outline-primary"},{default:L(()=>s[4]||(s[4]=[P(" Browse All Products ")])),_:1})])])):(m(),h("div",Ge,[e("div",We,[e("div",null,[e("div",Je,[e("div",Ke,[e("div",Qe,[s[9]||(s[9]=P(" Showing ")),e("span",null,$((X=c(n))==null?void 0:X.perPage)+" of "+$((Y=c(n))==null?void 0:Y.total),1),s[10]||(s[10]=P(" Products "))])]),e("div",Xe,[e("div",Ye,[s[12]||(s[12]=e("label",{for:"sortby"},"Sort by:",-1)),e("div",De,[we(e("select",{id:"sortby","onUpdate:modelValue":s[1]||(s[1]=o=>c(r).selectedSortOption=o),name:"sortby",class:"form-control"},s[11]||(s[11]=[e("option",{value:""},"Default",-1),e("option",{value:"name_asc"},"Name A - Z",-1),e("option",{value:"name_desc"},"Name Z - A",-1),e("option",{value:"created_at_asc"},"Latest First",-1),e("option",{value:"created_at_desc"}," Oldest First ",-1)]),512),[[Le,c(r).selectedSortOption]])])])])]),e("div",et,[e("div",tt,[(m(!0),h(A,null,N((D=c(n))==null?void 0:D.products,o=>(m(),h("div",{key:o.id,class:"col-6 col-md-3 col-lg-2 col-xl-2"},[e("div",st,[e("figure",at,[w(f,{to:("getProductLink"in i?i.getProductLink:c(q))(o)},{default:L(()=>[w(B,{src:("assetsSync"in i?i.assetsSync:c(ce))(o.main_image_path),alt:o==null?void 0:o.name,format:"webp",quality:"80",loading:"lazy",class:"w-full h-auto object-cover product-image"},null,8,["src","alt"])]),_:2},1032,["to"]),e("div",ot,[e("button",{type:"button",class:"btn-product btn-cart",onClick:F=>("addToCart"in i?i.addToCart:c($e))(o)},s[13]||(s[13]=[e("span",null,"Add to Cart",-1)]),8,it)])]),e("div",rt,[e("div",nt,[w(f,{to:("getProductLink"in i?i.getProductLink:c(q))(o)},{default:L(()=>{var F;return[P($((F=o.product_brand)==null?void 0:F.name),1)]}),_:2},1032,["to"])]),e("h3",lt,[w(f,{to:("getProductLink"in i?i.getProductLink:c(q))(o)},{default:L(()=>[P($(o==null?void 0:o.name),1)]),_:2},1032,["to"])])])])]))),128))])]),e("nav",ct,[e("ul",dt,[(m(!0),h(A,null,N((ee=c(n))==null?void 0:ee.links,o=>(m(),h("li",{key:o,class:ne(["page-item",{active:o==null?void 0:o.active}])},[w(f,{class:"page-link",to:H(o==null?void 0:o.url)},{default:L(()=>[e("span",{innerHTML:o==null?void 0:o.label},null,8,ut)]),_:2},1032,["to"])],2))),128))])])])]),e("aside",mt,[e("div",ht,[e("div",{class:"widget widget-clean"},[s[14]||(s[14]=e("label",null,"Filters:",-1)),e("button",{class:"btn btn-primary btn-sm sidebar-filter-clear",onClick:pe}," Clean All ")]),(te=c(n))!=null&&te.categories.length?(m(),h("div",pt,[s[15]||(s[15]=e("h3",{class:"widget-title"},[e("a",{"data-toggle":"collapse",href:"#widget-1",role:"button","aria-expanded":"true","aria-controls":"widget-1"}," Category ")],-1)),e("div",gt,[e("div",_t,[e("div",vt,[(m(!0),h(A,null,N((se=c(n))==null?void 0:se.categories,o=>{var F;return m(),h("div",{key:o.id,class:ne(["filter-item",{"is-loading":c(r).isFilterLoading}])},[e("div",bt,[e("input",{id:"cat-"+o.id,type:"checkbox",class:"custom-control-input",checked:(F=c(r).checkedCategories[u.value])==null?void 0:F.includes(o.id),value:o.id,disabled:c(r).isFilterLoading,onChange:U=>me(o.id)},null,40,ft),e("label",{class:"custom-control-label",for:"cat-"+o.id},$(o==null?void 0:o.name),9,yt),e("span",kt,[c(r).isFilterLoading?(m(),h("span",Ct)):(m(),h(A,{key:0},[P($(o.category_products_count),1)],64))])])],2)}),128))])])])])):re("",!0),e("div",St,[s[16]||(s[16]=e("h3",{class:"widget-title"},[e("a",{href:"#widget-4",role:"button","aria-expanded":"true","aria-controls":"widget-4"}," Brand ")],-1)),e("div",Ft,[e("div",wt,[e("div",Lt,[(m(!0),h(A,null,N((ae=c(n))==null?void 0:ae.brands,o=>{var F,U,oe;return m(),h("div",{key:o.id,class:"filter-item"},[e("div",$t,[e("input",{id:"brand-"+o.product_brand.id,type:"checkbox",class:"custom-control-input",checked:(F=c(r).checkedBrands[u.value])==null?void 0:F.includes(o.product_brand.id),value:o.product_brand.id,onChange:At=>he(o.product_brand.id)},null,40,Pt),e("label",{class:"custom-control-label",for:"brand-"+((U=o.product_brand)==null?void 0:U.id)},$((oe=o.product_brand)==null?void 0:oe.name),9,xt)])])}),128))])])])])])])]))]}),fallback:L(()=>[e("div",Bt,[e("div",Ot,[(m(),h(A,null,N(12,O=>e("div",{key:O,class:"col-6 col-md-3 col-lg-2 col-xl-2"},s[17]||(s[17]=[e("div",{class:"product product-7 text-center"},[e("div",{class:"product-media shimmer"},[e("div",{class:"product-image-shimmer"})]),e("div",{class:"product-body"},[e("div",{class:"product-cat"},[e("div",{class:"shimmer brand-shimmer"})]),e("div",{class:"product-title"},[e("div",{class:"shimmer title-shimmer"})])])],-1)]))),64))])])]),_:1})])])])}}});export{Vt as default};
