import{_ as ie}from"./Wnku4toj.js";import{_ as ae}from"./CLO1DuJ4.js";import{_ as re}from"./_ffBSurR.js";import{c as Z,g as O,a as ne,b as de}from"./dChgY4nu.js";import{a as ce}from"./DrkG6YK4.js";import{e as le,u as ue,r as N,f as me,g as he,c as n,a as e,b as p,w as g,t as _,h as r,F as C,i as y,j as G,o as d,d as b,k as pe,l as ge,v as _e,n as K,m as T}from"./9rquJSXI.js";import{u as ve}from"./Dk6RcS_9.js";import{u as be}from"./DktvYnX7.js";import{u as ke}from"./BfhTPuUJ.js";import"./CFC1fKq5.js";const fe=le("products",{state:()=>({isFilterLoading:!1,checkedCategories:{},checkedBrands:{},selectedSortOption:"",currentPage:1,perPage:12,trackApiCalls:0}),actions:{setIsFilterLoading(l){this.isFilterLoading=l},setCheckedCategories(l){this.checkedCategories=l},setCheckedBrands(l){this.checkedBrands=l},setSortOption(l){this.selectedSortOption=l},setCurrentPage(l){this.currentPage=l},incrementApiCalls(){this.trackApiCalls++},resetFilters(){this.checkedCategories={},this.checkedBrands={},this.selectedSortOption=""}},getters:{getFilters(){return{categories:this.checkedCategories,brands:this.checkedBrands,sort:this.selectedSortOption,page:this.currentPage,perPage:this.perPage,isFilterLoading:this.isFilterLoading,trackApiCalls:this.trackApiCalls}}}}),Ce={class:"main"},ye={"aria-label":"breadcrumb",class:"breadcrumb-nav border-0 mb-0"},we={class:"container d-flex align-items-center"},xe={class:"breadcrumb"},Pe={class:"breadcrumb-item"},Le={class:"breadcrumb-item"},Be={class:"breadcrumb-item active","aria-current":"page"},Fe={class:"page-content"},Se={class:"container"},Ae={key:0,class:"products mb-3 products-section"},$e={class:"row"},Oe={key:0,class:"error-content"},Ne={class:"error-actions"},Te={key:1,class:"row"},Ie={class:"col-lg-10"},Ve={class:"toolbox"},ze={class:"toolbox-left"},De={class:"toolbox-info"},Me={class:"toolbox-right"},He={class:"toolbox-sort"},je={class:"select-custom"},Ee={class:"products mb-3 products-section"},qe={class:"row"},Je={class:"product product-7 text-center"},Re={class:"product-media"},Ue={class:"product-action"},We=["onClick"],Ze={class:"product-body"},Ge={class:"product-cat"},Ke={class:"product-title"},Qe={"aria-label":"Page navigation"},Xe={class:"pagination justify-content-center"},Ye=["innerHTML"],et={class:"col-lg-2 order-lg-first"},tt={class:"sidebar sidebar-shop sidebar-shop-category"},st={key:0,class:"widget widget-collapsible"},ot={id:"widget-1",class:"show"},it={class:"widget-body"},at={class:"filter-items filter-items-count"},rt={class:"custom-control custom-checkbox"},nt=["id","checked","value","disabled","onChange"],dt=["for"],ct={class:"item-count"},lt={key:1,class:"count-shimmer shimmer"},ut={class:"widget widget-collapsible"},mt={id:"widget-4",class:"show"},ht={class:"widget-body"},pt={class:"filter-items"},gt={class:"custom-control custom-checkbox"},_t=["id","checked","value","onChange"],vt=["for"],bt={class:"products mb-3 products-section"},kt={class:"row"},$t={__name:"[...slug]",async setup(l){let x,I;const P=ue(),{segment:L,id:B}=P.params,{api:Q}=ve(),V=Array.isArray(P.params.slug)?P.params.slug:[P.params.slug],S=V[0],z=V[2],X=N(!1),o=fe(),F=a=>{const t=a==null?void 0:a.split("page=")[1];return a?`/${L}/${B}/${S}/page/${t}`:`/${L}/${B}/${S}`},D=N(`${Z(L)} - ${Z(S)}`),v=N(B?parseInt(B):1);z&&o.setCurrentPage(parseInt(z));const A=me(()=>de(L)),{data:u,refresh:w,status:Y,error:ee}=([x,I]=he(async()=>be(`products-${v.value}-${o.currentPage}-${JSON.stringify(o.checkedCategories)}-${JSON.stringify(o.checkedBrands)}-${o.selectedSortOption}`,async()=>{const a={[v.value]:o.checkedCategories[v.value]||[]};o.setCheckedCategories(a);const t={[v.value]:o.checkedBrands[v.value]||[]};o.setCheckedBrands(t);const i=await Q.get("/api/get-products",{params:{category_id:v.value,page:o.currentPage,per_page:o.perPage,checkedCategories:o.checkedCategories,checkedBrands:o.checkedBrands,selectedSortOption:o.selectedSortOption}});return X.value=!0,{products:i.data.products.data,total:i.data.products.total,perPage:i.data.products.per_page,categories:i.data.categories,brands:i.data.brands,theCategory:i.data.the_category,totalPages:i.data.products.last_page,next_page_url:i.data.products.next_page_url,prev_page_url:i.data.products.prev_page_url,links:i.data.products.links}},{server:!0,lazy:!1,watch:[()=>o.currentPage]})),x=await x,I(),x);ke({title:D,meta:[{name:"description",content:D}]});async function te(a){var f;o.setIsFilterLoading(!0);let t=(f=u.value)==null?void 0:f.theCategory.id;if(!(t in o.checkedCategories)){const c={...o.checkedCategories};c[t]=[],o.setCheckedCategories(c)}const i=[...o.checkedCategories[t]||[]];if(i.includes(a)){const c=i.indexOf(a);i.splice(c,1)}else i.push(a);const k={...o.checkedCategories};k[t]=i,o.setCheckedCategories(k);try{T().push(F("page=1")),await w()}finally{o.setIsFilterLoading(!1)}}async function se(a){var f;o.setIsFilterLoading(!0);let t=(f=u.value)==null?void 0:f.theCategory.id;if(!(t in o.checkedBrands)){const c={...o.checkedBrands};c[t]=[],o.setCheckedBrands(c)}const i=[...o.checkedBrands[t]||[]];if(i.includes(a)){const c=i.indexOf(a);i.splice(c,1)}else i.push(a);const k={...o.checkedBrands};k[t]=i,o.setCheckedBrands(k);try{T().push(F("page=1")),await w()}finally{o.setIsFilterLoading(!1)}}async function oe(){o.setIsFilterLoading(!0),document.querySelectorAll('input[type="checkbox"]').forEach(t=>{t.checked=!1}),o.resetFilters();try{T().push(F("page=1")),await w()}finally{o.setIsFilterLoading(!1)}}return(a,t)=>{var c,M;const i=ie,k=ae,f=re;return d(),n("main",Ce,[e("nav",ye,[e("div",we,[e("ol",xe,[e("li",Pe,[p(i,{to:"/"},{default:g(()=>t[2]||(t[2]=[b("HOME")])),_:1})]),e("li",Le,[p(i,{to:`/${A.value.slug}`},{default:g(()=>{var m;return[b(_((m=A.value)==null?void 0:m.name.toUpperCase()),1)]}),_:1},8,["to"])]),e("li",Be,_((M=(c=r(u))==null?void 0:c.theCategory)==null?void 0:M.name),1)])])]),e("div",Fe,[e("div",Se,[r(Y)=="pending"?(d(),n("div",Ae,[e("div",$e,[(d(),n(C,null,y(12,m=>e("div",{key:m,class:"col-6 col-md-3 col-lg-2 col-xl-2"},t[3]||(t[3]=[pe('<div class="product product-7 text-center"><div class="product-media shimmer"><div class="product-image-shimmer"></div></div><div class="product-body"><div class="product-cat"><div class="shimmer brand-shimmer"></div></div><div class="product-title"><div class="shimmer title-shimmer"></div></div></div></div>',1)]))),64))])])):G("",!0),p(f,null,{default:g(()=>{var m,H,j,E,q,J,R,U;return[r(ee)||!((m=A.value)!=null&&m.active)?(d(),n("div",Oe,[t[5]||(t[5]=e("i",{class:"icon-exclamation-circle text-danger mb-4",style:{"font-size":"3rem"}},null,-1)),t[6]||(t[6]=e("h2",{class:"error-title mb-3"},"No Products Found",-1)),t[7]||(t[7]=e("p",{class:"error-message text-muted mb-4"}," We couldn't find any products in this category. This might be because: ",-1)),t[8]||(t[8]=e("ul",{class:"error-reasons text-left mb-4 mx-auto",style:{"max-width":"400px"}},[e("li",null,"The selected filters might be too restrictive"),e("li",null,"The category might be temporarily empty"),e("li",null,"New products might be coming soon")],-1)),e("div",Ne,[e("button",{class:"btn btn-primary me-3",onClick:t[0]||(t[0]=(...s)=>r(w)&&r(w)(...s))}," Try Again "),p(i,{to:"/",class:"btn btn-outline-primary"},{default:g(()=>t[4]||(t[4]=[b(" Browse All Products ")])),_:1})])])):(d(),n("div",Te,[e("div",Ie,[e("div",null,[e("div",Ve,[e("div",ze,[e("div",De,[t[9]||(t[9]=b(" Showing ")),e("span",null,_((H=r(u))==null?void 0:H.perPage)+" of "+_((j=r(u))==null?void 0:j.total),1),t[10]||(t[10]=b(" Products "))])]),e("div",Me,[e("div",He,[t[12]||(t[12]=e("label",{for:"sortby"},"Sort by:",-1)),e("div",je,[ge(e("select",{id:"sortby","onUpdate:modelValue":t[1]||(t[1]=s=>r(o).selectedSortOption=s),name:"sortby",class:"form-control"},t[11]||(t[11]=[e("option",{value:""},"Default",-1),e("option",{value:"name_asc"},"Name A - Z",-1),e("option",{value:"name_desc"},"Name Z - A",-1),e("option",{value:"created_at_asc"},"Latest First",-1),e("option",{value:"created_at_desc"}," Oldest First ",-1)]),512),[[_e,r(o).selectedSortOption]])])])])]),e("div",Ee,[e("div",qe,[(d(!0),n(C,null,y((E=r(u))==null?void 0:E.products,s=>(d(),n("div",{key:s.id,class:"col-6 col-md-3 col-lg-2 col-xl-2"},[e("div",Je,[e("figure",Re,[p(i,{to:("getProductLink"in a?a.getProductLink:r(O))(s)},{default:g(()=>[p(k,{src:("assets"in a?a.assets:r(ce))(s.main_image_path),alt:s==null?void 0:s.name,format:"webp",quality:"80",loading:"lazy",class:"w-full h-auto object-cover product-image"},null,8,["src","alt"])]),_:2},1032,["to"]),e("div",Ue,[e("button",{type:"button",class:"btn-product btn-cart",onClick:h=>("addToCart"in a?a.addToCart:r(ne))(s)},t[13]||(t[13]=[e("span",null,"Add to Cart",-1)]),8,We)])]),e("div",Ze,[e("div",Ge,[p(i,{to:("getProductLink"in a?a.getProductLink:r(O))(s)},{default:g(()=>{var h;return[b(_((h=s.product_brand)==null?void 0:h.name),1)]}),_:2},1032,["to"])]),e("h3",Ke,[p(i,{to:("getProductLink"in a?a.getProductLink:r(O))(s)},{default:g(()=>[b(_(s==null?void 0:s.name),1)]),_:2},1032,["to"])])])])]))),128))])]),e("nav",Qe,[e("ul",Xe,[(d(!0),n(C,null,y((q=r(u))==null?void 0:q.links,s=>(d(),n("li",{key:s,class:K(["page-item",{active:s==null?void 0:s.active}])},[p(i,{class:"page-link",to:F(s==null?void 0:s.url)},{default:g(()=>[e("span",{innerHTML:s==null?void 0:s.label},null,8,Ye)]),_:2},1032,["to"])],2))),128))])])])]),e("aside",et,[e("div",tt,[e("div",{class:"widget widget-clean"},[t[14]||(t[14]=e("label",null,"Filters:",-1)),e("button",{class:"btn btn-primary btn-sm sidebar-filter-clear",onClick:oe}," Clean All ")]),(J=r(u))!=null&&J.categories.length?(d(),n("div",st,[t[15]||(t[15]=e("h3",{class:"widget-title"},[e("a",{"data-toggle":"collapse",href:"#widget-1",role:"button","aria-expanded":"true","aria-controls":"widget-1"}," Category ")],-1)),e("div",ot,[e("div",it,[e("div",at,[(d(!0),n(C,null,y((R=r(u))==null?void 0:R.categories,s=>{var h;return d(),n("div",{key:s.id,class:K(["filter-item",{"is-loading":r(o).isFilterLoading}])},[e("div",rt,[e("input",{id:"cat-"+s.id,type:"checkbox",class:"custom-control-input",checked:(h=r(o).checkedCategories[v.value])==null?void 0:h.includes(s.id),value:s.id,disabled:r(o).isFilterLoading,onChange:$=>te(s.id)},null,40,nt),e("label",{class:"custom-control-label",for:"cat-"+s.id},_(s==null?void 0:s.name),9,dt),e("span",ct,[r(o).isFilterLoading?(d(),n("span",lt)):(d(),n(C,{key:0},[b(_(s.category_products_count),1)],64))])])],2)}),128))])])])])):G("",!0),e("div",ut,[t[16]||(t[16]=e("h3",{class:"widget-title"},[e("a",{href:"#widget-4",role:"button","aria-expanded":"true","aria-controls":"widget-4"}," Brand ")],-1)),e("div",mt,[e("div",ht,[e("div",pt,[(d(!0),n(C,null,y((U=r(u))==null?void 0:U.brands,s=>{var h,$,W;return d(),n("div",{key:s.id,class:"filter-item"},[e("div",gt,[e("input",{id:"brand-"+s.product_brand.id,type:"checkbox",class:"custom-control-input",checked:(h=r(o).checkedBrands[v.value])==null?void 0:h.includes(s.product_brand.id),value:s.product_brand.id,onChange:ft=>se(s.product_brand.id)},null,40,_t),e("label",{class:"custom-control-label",for:"brand-"+(($=s.product_brand)==null?void 0:$.id)},_((W=s.product_brand)==null?void 0:W.name),9,vt)])])}),128))])])])])])])]))]}),fallback:g(()=>[e("div",bt,[e("div",kt,[(d(),n(C,null,y(12,m=>e("div",{key:m,class:"col-6 col-md-3 col-lg-2 col-xl-2"},t[17]||(t[17]=[e("div",{class:"product product-7 text-center"},[e("div",{class:"product-media shimmer"},[e("div",{class:"product-image-shimmer"})]),e("div",{class:"product-body"},[e("div",{class:"product-cat"},[e("div",{class:"shimmer brand-shimmer"})]),e("div",{class:"product-title"},[e("div",{class:"shimmer title-shimmer"})])])],-1)]))),64))])])]),_:1})])])])}}};export{$t as default};
