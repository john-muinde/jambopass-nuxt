import{_ as X}from"./DiX9QcOE.js";import{_ as Y}from"./xZHzdsY3.js";import{_ as ee}from"./HvgV4h_z.js";import{c as E,g as A,a as te,d as se}from"./CGcZhe3G.js";import{a as oe}from"./Cr3VIkzR.js";import{p as ae,u as ie,r as J,e as re,f as ne,c as n,a as e,b as h,w as m,t as g,i as r,o as c,d as b,k as ce,v as de,F as f,l as C,n as R,j as le,q as $}from"./DqP3LHpI.js";import{u as ue}from"./DrFZB5Ui.js";import{u as pe}from"./BBLMdrEF.js";import{u as he}from"./BDNeig0V.js";import"./_O3UyVST.js";const me=ae("products",{state:()=>({isFilterLoading:!1,checkedCategories:{},checkedBrands:{},selectedSortOption:"",currentPage:1,perPage:12,trackApiCalls:0}),actions:{setIsFilterLoading(l){this.isFilterLoading=l},setCheckedCategories(l){this.checkedCategories=l},setCheckedBrands(l){this.checkedBrands=l},setSortOption(l){this.selectedSortOption=l},setCurrentPage(l){this.currentPage=l},incrementApiCalls(){this.trackApiCalls++},resetFilters(){this.checkedCategories={},this.checkedBrands={},this.selectedSortOption=""}},getters:{getFilters(){return{categories:this.checkedCategories,brands:this.checkedBrands,sort:this.selectedSortOption,page:this.currentPage,perPage:this.perPage,isFilterLoading:this.isFilterLoading,trackApiCalls:this.trackApiCalls}}}}),ge={class:"main"},_e={"aria-label":"breadcrumb",class:"breadcrumb-nav border-0 mb-0"},be={class:"container d-flex align-items-center"},ke={class:"breadcrumb"},ve={class:"breadcrumb-item"},fe={class:"breadcrumb-item"},Ce={class:"breadcrumb-item active","aria-current":"page"},ye={class:"page-content"},we={class:"container"},xe={class:"row"},Pe={class:"col-lg-10"},Le={key:0,class:"error-content"},Be={class:"error-actions"},Fe={key:1},Se={class:"toolbox"},Ae={class:"toolbox-left"},$e={class:"toolbox-info"},Oe={class:"toolbox-right"},Ne={class:"toolbox-sort"},Te={class:"select-custom"},Ie={class:"products mb-3 products-section"},Ve={class:"row"},ze={class:"product product-7 text-center"},De={class:"product-media"},Me={class:"product-action"},He=["onClick"],je={class:"product-body"},qe={class:"product-cat"},Ee={class:"product-title"},Je={"aria-label":"Page navigation"},Re={class:"pagination justify-content-center"},Ue=["innerHTML"],We={class:"col-lg-2 order-lg-first"},Ze={class:"sidebar sidebar-shop sidebar-shop-category"},Ge={key:0,class:"widget widget-collapsible"},Ke={id:"widget-1",class:"show"},Qe={class:"widget-body"},Xe={class:"filter-items filter-items-count"},Ye={class:"custom-control custom-checkbox"},et=["id","checked","value","disabled","onChange"],tt=["for"],st={class:"item-count"},ot={key:1,class:"count-shimmer shimmer"},at={class:"widget widget-collapsible"},it={id:"widget-4",class:"show"},rt={class:"widget-body"},nt={class:"filter-items"},ct={class:"custom-control custom-checkbox"},dt=["id","checked","value","onChange"],lt=["for"],ut={class:"products mb-3 products-section"},pt={class:"row"},wt={__name:"[...slug]",async setup(l){let y,O;const w=ie(),{segment:x,id:P}=w.params,{api:U}=ue(),N=Array.isArray(w.params.slug)?w.params.slug:[w.params.slug],F=N[0],T=N[2],s=me(),L=i=>{const t=i==null?void 0:i.split("page=")[1];return i?`/${x}/${P}/${F}/page/${t}`:`/${x}/${P}/${F}`},I=J(`${E(x)} - ${E(F)}`),_=J(P?parseInt(P):1);T&&s.setCurrentPage(parseInt(T));const V=re(()=>se(x)),{data:u,refresh:S,error:W}=([y,O]=ne(async()=>pe(`products-${_.value}-${s.currentPage}-${JSON.stringify(s.checkedCategories)}-${JSON.stringify(s.checkedBrands)}-${s.selectedSortOption}`,async()=>{const i={[_.value]:s.checkedCategories[_.value]||[]};s.setCheckedCategories(i);const t={[_.value]:s.checkedBrands[_.value]||[]};s.setCheckedBrands(t),console.log("Fetching products... ",s.trackApiCalls++);const a=await U.get("/api/get-products",{params:{page:s.currentPage,per_page:s.perPage,category_id:_.value,checkedCategories:s.checkedCategories,checkedBrands:s.checkedBrands,selectedSortOption:s.selectedSortOption}});return{products:a.data.products.data,total:a.data.products.total,perPage:a.data.products.per_page,categories:a.data.categories,brands:a.data.brands,theCategory:a.data.the_category,totalPages:a.data.products.last_page,next_page_url:a.data.products.next_page_url,prev_page_url:a.data.products.prev_page_url,links:a.data.products.links}},{server:!0,lazy:!1,watch:[()=>s.currentPage]})),y=await y,O(),y);async function Z(i){var v;s.setIsFilterLoading(!0);let t=(v=u.value)==null?void 0:v.theCategory.id;if(!(t in s.checkedCategories)){const d={...s.checkedCategories};d[t]=[],s.setCheckedCategories(d)}const a=[...s.checkedCategories[t]||[]];if(a.includes(i)){const d=a.indexOf(i);a.splice(d,1)}else a.push(i);const k={...s.checkedCategories};k[t]=a,s.setCheckedCategories(k);try{$().push(L("page=1")),await S()}finally{s.setIsFilterLoading(!1)}}async function G(i){var v;s.setIsFilterLoading(!0);let t=(v=u.value)==null?void 0:v.theCategory.id;if(!(t in s.checkedBrands)){const d={...s.checkedBrands};d[t]=[],s.setCheckedBrands(d)}const a=[...s.checkedBrands[t]||[]];if(a.includes(i)){const d=a.indexOf(i);a.splice(d,1)}else a.push(i);const k={...s.checkedBrands};k[t]=a,s.setCheckedBrands(k);try{$().push(L("page=1")),await S()}finally{s.setIsFilterLoading(!1)}}async function K(){s.setIsFilterLoading(!0),document.querySelectorAll('input[type="checkbox"]').forEach(t=>{t.checked=!1}),s.resetFilters();try{$().push(L("page=1")),await S()}finally{s.setIsFilterLoading(!1)}}return he({title:I,meta:[{name:"description",content:I}]}),(i,t)=>{var d;const a=X,k=Y,v=ee;return c(),n("main",ge,[e("nav",_e,[e("div",be,[e("ol",ke,[e("li",ve,[h(a,{to:"/"},{default:m(()=>t[1]||(t[1]=[b("HOME")])),_:1})]),e("li",fe,[h(a,{to:`/${V.value.slug}`},{default:m(()=>[b(g(V.value.name.toUpperCase()),1)]),_:1},8,["to"])]),e("li",Ce,g((d=r(u))==null?void 0:d.theCategory.name),1)])])]),e("div",ye,[e("div",we,[h(v,null,{default:m(()=>{var B,z,D,M,H,j,q;return[e("div",xe,[e("div",Pe,[r(W)?(c(),n("div",Le,[t[4]||(t[4]=e("i",{class:"icon-exclamation-circle text-danger mb-4",style:{"font-size":"3rem"}},null,-1)),t[5]||(t[5]=e("h2",{class:"error-title mb-3"},"No Products Found",-1)),t[6]||(t[6]=e("p",{class:"error-message text-muted mb-4"}," We couldn't find any products in this category. This might be because: ",-1)),t[7]||(t[7]=e("ul",{class:"error-reasons text-left mb-4 mx-auto",style:{"max-width":"400px"}},[e("li",null,"The selected filters might be too restrictive"),e("li",null,"The category might be temporarily empty"),e("li",null,"New products might be coming soon")],-1)),e("div",Be,[t[3]||(t[3]=e("button",{class:"btn btn-primary me-3",onClick:()=>null}," Try Again ",-1)),h(a,{to:"/",class:"btn btn-outline-primary"},{default:m(()=>t[2]||(t[2]=[b(" Browse All Products ")])),_:1})])])):(c(),n("div",Fe,[e("div",Se,[e("div",Ae,[e("div",$e,[t[8]||(t[8]=b(" Showing ")),e("span",null,g((B=r(u))==null?void 0:B.perPage)+" of "+g((z=r(u))==null?void 0:z.total),1),t[9]||(t[9]=b(" Products "))])]),e("div",Oe,[e("div",Ne,[t[11]||(t[11]=e("label",{for:"sortby"},"Sort by:",-1)),e("div",Te,[ce(e("select",{id:"sortby","onUpdate:modelValue":t[0]||(t[0]=o=>r(s).selectedSortOption=o),name:"sortby",class:"form-control"},t[10]||(t[10]=[e("option",{value:""},"Default",-1),e("option",{value:"name_asc"},"Name A - Z",-1),e("option",{value:"name_desc"},"Name Z - A",-1),e("option",{value:"created_at_asc"},"Latest First",-1),e("option",{value:"created_at_desc"}," Oldest First ",-1)]),512),[[de,r(s).selectedSortOption]])])])])]),e("div",Ie,[e("div",Ve,[(c(!0),n(f,null,C((D=r(u))==null?void 0:D.products,o=>(c(),n("div",{key:o.id,class:"col-6 col-md-3 col-lg-2 col-xl-2"},[e("div",ze,[e("figure",De,[h(a,{to:("getProductLink"in i?i.getProductLink:r(A))(o)},{default:m(()=>[h(k,{src:("assets"in i?i.assets:r(oe))(o.main_image_path),alt:o.name,format:"webp",quality:"80",loading:"lazy",class:"w-full h-auto object-cover product-image"},null,8,["src","alt"])]),_:2},1032,["to"]),e("div",Me,[e("button",{type:"button",class:"btn-product btn-cart",onClick:p=>("addToCart"in i?i.addToCart:r(te))(o)},t[12]||(t[12]=[e("span",null,"Add to Cart",-1)]),8,He)])]),e("div",je,[e("div",qe,[h(a,{to:("getProductLink"in i?i.getProductLink:r(A))(o)},{default:m(()=>{var p;return[b(g((p=o.product_brand)==null?void 0:p.name),1)]}),_:2},1032,["to"])]),e("h3",Ee,[h(a,{to:("getProductLink"in i?i.getProductLink:r(A))(o)},{default:m(()=>[b(g(o.name),1)]),_:2},1032,["to"])])])])]))),128))])]),e("nav",Je,[e("ul",Re,[(c(!0),n(f,null,C((M=r(u))==null?void 0:M.links,o=>(c(),n("li",{key:o,class:R(["page-item",{active:o==null?void 0:o.active}])},[h(a,{class:"page-link",to:L(o==null?void 0:o.url)},{default:m(()=>[e("span",{innerHTML:o==null?void 0:o.label},null,8,Ue)]),_:2},1032,["to"])],2))),128))])])]))]),e("aside",We,[e("div",Ze,[e("div",{class:"widget widget-clean"},[t[13]||(t[13]=e("label",null,"Filters:",-1)),e("button",{class:"btn btn-primary btn-sm sidebar-filter-clear",onClick:K}," Clean All ")]),(H=r(u))!=null&&H.categories.length?(c(),n("div",Ge,[t[14]||(t[14]=e("h3",{class:"widget-title"},[e("a",{"data-toggle":"collapse",href:"#widget-1",role:"button","aria-expanded":"true","aria-controls":"widget-1"}," Category ")],-1)),e("div",Ke,[e("div",Qe,[e("div",Xe,[(c(!0),n(f,null,C((j=r(u))==null?void 0:j.categories,o=>{var p;return c(),n("div",{key:o.id,class:R(["filter-item",{"is-loading":r(s).isFilterLoading}])},[e("div",Ye,[e("input",{id:"cat-"+o.id,type:"checkbox",class:"custom-control-input",checked:(p=r(s).checkedCategories[_.value])==null?void 0:p.includes(o.id),value:o.id,disabled:r(s).isFilterLoading,onChange:Q=>Z(o.id)},null,40,et),e("label",{class:"custom-control-label",for:"cat-"+o.id},g(o.name),9,tt),e("span",st,[r(s).isFilterLoading?(c(),n("span",ot)):(c(),n(f,{key:0},[b(g(o.category_products_count),1)],64))])])],2)}),128))])])])])):le("",!0),e("div",at,[t[15]||(t[15]=e("h3",{class:"widget-title"},[e("a",{href:"#widget-4",role:"button","aria-expanded":"true","aria-controls":"widget-4"}," Brand ")],-1)),e("div",it,[e("div",rt,[e("div",nt,[(c(!0),n(f,null,C((q=r(u))==null?void 0:q.brands,o=>{var p;return c(),n("div",{key:o.id,class:"filter-item"},[e("div",ct,[e("input",{id:"brand-"+o.product_brand.id,type:"checkbox",class:"custom-control-input",checked:(p=r(s).checkedBrands[_.value])==null?void 0:p.includes(o.product_brand.id),value:o.product_brand.id,onChange:Q=>G(o.product_brand.id)},null,40,dt),e("label",{class:"custom-control-label",for:"brand-"+o.product_brand.id},g(o.product_brand.name),9,lt)])])}),128))])])])])])])])]}),fallback:m(()=>[e("div",ut,[e("div",pt,[(c(),n(f,null,C(12,B=>e("div",{key:B,class:"col-6 col-md-3 col-lg-2 col-xl-2"},t[16]||(t[16]=[e("div",{class:"product product-7 text-center"},[e("div",{class:"product-media shimmer"},[e("div",{class:"product-image-shimmer"})]),e("div",{class:"product-body"},[e("div",{class:"product-cat"},[e("div",{class:"shimmer brand-shimmer"})]),e("div",{class:"product-title"},[e("div",{class:"shimmer title-shimmer"})])])],-1)]))),64))])])]),_:1})])])])}}};export{wt as default};
