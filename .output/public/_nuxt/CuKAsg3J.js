import{_ as ge}from"./B_KAXnXH.js";import{_ as _e}from"./BE6UyyAW.js";import{_ as ve}from"./kdAzBprg.js";import{e as be,n as fe,u as ce,f as H,g as q,h as ye,i as ke,j as Ce,r as re,k as Se,l as Fe,o as p,c as h,a as e,b as w,w as L,d as P,t as S,m as c,F as A,p as E,q as ne,s as we,v as Le,x as $e,y as le}from"./D3l_0aZV.js";import{a as de}from"./C6-auSY3.js";import{u as ue,a as Pe}from"./BuoUW_pf.js";import{u as xe}from"./Dexhekq4.js";import{u as Be}from"./DEuxkUXt.js";const Oe=be("products",{state:()=>({isFilterLoading:!1,checkedCategories:{},checkedBrands:{},selectedSortOption:"",currentPage:1,perPage:12,trackApiCalls:0}),actions:{setIsFilterLoading(t){this.$patch(o=>{o.isFilterLoading=t})},setCheckedCategories(t){this.$patch(o=>{o.checkedCategories={...t}})},async addCategoryFilter(t,o){this.$patch(l=>{l.checkedCategories[t]||(l.checkedCategories[t]=[]),l.checkedCategories[t].includes(o)||(l.checkedCategories[t]=[...l.checkedCategories[t],o])})},async removeCategoryFilter(t,o){this.$patch(l=>{l.checkedCategories[t]&&(l.checkedCategories[t]=l.checkedCategories[t].filter(y=>y!==o))})},setCheckedBrands(t){this.$patch(o=>{o.checkedBrands={...t}})},async addBrandFilter(t,o){this.$patch(l=>{l.checkedBrands[t]||(l.checkedBrands[t]=[]),l.checkedBrands[t].includes(o)||(l.checkedBrands[t]=[...l.checkedBrands[t],o])})},async removeBrandFilter(t,o){this.$patch(l=>{l.checkedBrands[t]&&(l.checkedBrands[t]=l.checkedBrands[t].filter(y=>y!==o))})},setSortOption(t){this.$patch(o=>{o.selectedSortOption=t})},setCurrentPage(t){this.$patch(o=>{o.currentPage=t})},incrementApiCalls(){this.$patch(t=>{t.trackApiCalls++})},resetFilters(){this.$patch(t=>{t.checkedCategories={},t.checkedBrands={},t.selectedSortOption="",t.currentPage=1})},async applyFilters(t,o,l){if(!this.isFilterLoading){this.setIsFilterLoading(!0);try{await Promise.all([this.setCurrentPage(1),o.push(l("page=1"))]),this.incrementApiCalls()}catch(y){console.error("Error applying filters:",y)}finally{await fe(),this.setIsFilterLoading(!1)}}}},getters:{getFilters:t=>({...t,checkedCategories:t.checkedCategories,checkedBrands:t.checkedBrands}),hasActiveFilters:t=>{const o=Object.values(t.checkedCategories).some(y=>y.length>0),l=Object.values(t.checkedBrands).some(y=>y.length>0);return o||l||!!t.selectedSortOption},getActiveCategoryFilters:t=>o=>[...t.checkedCategories[o]||[]],getActiveBrandFilters:t=>o=>[...t.checkedBrands[o]||[]],getCurrentPageFilters:t=>({page:t.currentPage,perPage:t.perPage})}}),Ae=(t,o)=>{const l=ce(),{generateSeoMeta:y,generateHeadInput:G,generateContentMetaTags:$,config:N}=ue(),T=()=>{var u,d,r,m;const g=(d=(u=t.value)==null?void 0:u.brands)==null?void 0:d.map(k=>{var b;return(b=k.product_brand)==null?void 0:b.name}).filter(Boolean).slice(0,3).join(", "),_=(m=(r=t.value)==null?void 0:r.theCategory)==null?void 0:m.name,v=o==null?void 0:o.name;return`Explore our selection of ${_} products in the ${v} category. 
            Browse top brands like ${g} and more. 
            Professional ${v.toLowerCase()} solutions by Sheffield Steel Systems in East Africa.`},M=H(()=>{var g,_,v,u,d,r,m,k,b,x,I;return $({type:"productList",content:{name:`${(_=(g=t.value)==null?void 0:g.theCategory)==null?void 0:_.name} - ${o==null?void 0:o.name} Products`,description:T(),keywords:`${o==null?void 0:o.keywords}, 
                  ${(u=(v=t.value)==null?void 0:v.theCategory)==null?void 0:u.name}, 
                  ${(r=(d=t.value)==null?void 0:d.brands)==null?void 0:r.map(j=>{var V;return(V=j.product_brand)==null?void 0:V.name}).join(", ")},
                  ${(k=(m=t.value)==null?void 0:m.products)==null?void 0:k.map(j=>j.name).join(", ")}`,main_image_path:(I=(x=(b=t.value)==null?void 0:b.products)==null?void 0:x[0])==null?void 0:I.main_image_path}})}),R=H(()=>{var g,_,v,u,d;return{"@context":"https://schema.org","@type":"ItemList",name:`${(_=(g=t.value)==null?void 0:g.theCategory)==null?void 0:_.name} Products by Sheffield Steel Systems`,description:T(),numberOfItems:((v=t.value)==null?void 0:v.total)||0,itemListElement:((d=(u=t.value)==null?void 0:u.products)==null?void 0:d.map((r,m)=>{var k,b,x;return{"@type":"ListItem",position:m+1,item:{"@type":"Product",name:r.name,image:de(r.main_image_path),url:q(r),brand:{"@type":"Brand",name:((k=r.product_brand)==null?void 0:k.name)||"Sheffield Steel Systems"},category:(x=(b=t.value)==null?void 0:b.theCategory)==null?void 0:x.name,description:r.description||`Professional ${r.name} by Sheffield Steel Systems`,manufacturer:{"@type":"Organization",name:"Sheffield Steel Systems","@id":"https://sheffieldafrica.com/#organization"},offers:{"@type":"Offer",availability:"https://schema.org/InStock",seller:{"@type":"Organization",name:"Sheffield Steel Systems","@id":"https://sheffieldafrica.com/#organization"}}}}}))||[]}}),n=H(()=>{var g,_;return{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,item:{"@id":N.url,name:"Home"}},{"@type":"ListItem",position:2,item:{"@id":`${N.url}/${o==null?void 0:o.slug}`,name:o==null?void 0:o.name}},{"@type":"ListItem",position:3,item:{"@id":N.url+l.fullPath,name:(_=(g=t.value)==null?void 0:g.theCategory)==null?void 0:_.name}}]}}),U=H(()=>{var g,_,v,u,d,r;return{"@context":"https://schema.org","@type":"FilterList",name:`Filters for ${(_=(g=t.value)==null?void 0:g.theCategory)==null?void 0:_.name}`,itemListElement:[{"@type":"FilterSection",name:"Categories",filterOptions:(u=(v=t.value)==null?void 0:v.categories)==null?void 0:u.map(m=>({"@type":"FilterOption",name:m.name,value:m.id}))},{"@type":"FilterSection",name:"Brands",filterOptions:(r=(d=t.value)==null?void 0:d.brands)==null?void 0:r.map(m=>{var k,b;return{"@type":"FilterOption",name:(k=m.product_brand)==null?void 0:k.name,value:(b=m.product_brand)==null?void 0:b.id}})}]}});return{metaTags:M,productListSchema:R,breadcrumbSchema:n,filterSchema:U}},Ne={class:"main"},Te={"aria-label":"breadcrumb",class:"breadcrumb-nav border-0 mb-0"},Me={class:"container d-flex align-items-center"},Ee={class:"breadcrumb"},je={class:"breadcrumb-item"},ze={class:"breadcrumb-item"},He={class:"breadcrumb-item active","aria-current":"page"},Ie={class:"page-content"},Ve={class:"container"},qe={key:0,class:"products mb-3 products-section"},Re={class:"row"},Ue={key:1,class:"error-content"},Ze={class:"error-reasons text-left mb-4 mx-auto",style:{"max-width":"400px"}},Ge={class:"error-actions"},We={key:2,class:"row"},Je={class:"col-lg-10"},Ke={class:"toolbox"},Qe={class:"toolbox-left"},Xe={class:"toolbox-info"},Ye={class:"toolbox-right"},De={class:"toolbox-sort"},et={class:"select-custom"},tt={class:"products mb-3 products-section"},st={class:"row"},ot={class:"product product-7 text-center"},at={class:"product-media"},it={class:"product-action"},rt=["onClick"],nt={class:"product-body"},lt={class:"product-cat"},ct={class:"product-title"},dt={"aria-label":"Page navigation"},ut={class:"pagination justify-content-center"},mt=["innerHTML"],pt={class:"col-lg-2 order-lg-first"},ht={class:"sidebar sidebar-shop sidebar-shop-category"},gt={key:0,class:"widget widget-collapsible"},_t={id:"widget-1",class:"show"},vt={class:"widget-body"},bt={class:"filter-items filter-items-count"},ft={class:"custom-control custom-checkbox"},yt=["id","checked","value","disabled","onChange"],kt=["for"],Ct={class:"item-count"},St={key:1,class:"count-shimmer shimmer"},Ft={class:"widget widget-collapsible"},wt={id:"widget-4",class:"show"},Lt={class:"widget-body"},$t={class:"filter-items"},Pt={class:"custom-control custom-checkbox"},xt=["id","checked","value","onChange"],Bt=["for"],Ot={class:"products mb-3 products-section"},At={class:"row"},qt=ye({__name:"[...slug]",async setup(t){let o,l;const{generateSeoMeta:y,generateHeadInput:G}=ue(),$=ce(),N=ke(),{segment:T,id:M}=$.params,{api:R}=Ce(),n=Oe(),U=Array.isArray($.params.slug)?$.params.slug:[$.params.slug],[g,,_]=U,v=re(!1),u=re(M?parseInt(M):1),d=H(()=>Se(T)),{data:r,refresh:m,error:k,status:b}=([o,l]=Fe(async()=>xe(`products-${u.value}-${n.currentPage}`,async()=>{const i=await R.get("/api/get-products",{params:{category_id:u.value,page:n.currentPage,per_page:n.perPage,checkedCategories:n.checkedCategories,checkedBrands:n.checkedBrands,selectedSortOption:n.selectedSortOption}});return v.value=!0,{products:i.data.products.data,total:i.data.products.total,perPage:i.data.products.per_page,categories:i.data.categories,brands:i.data.brands,theCategory:i.data.the_category,totalPages:i.data.products.last_page,next_page_url:i.data.products.next_page_url,prev_page_url:i.data.products.prev_page_url,links:i.data.products.links}},{server:!0,immediate:!0})),o=await o,l(),o),{metaTags:x,productListSchema:I,breadcrumbSchema:j,filterSchema:V}=Ae(r,d.value),z=i=>{const s=i==null?void 0:i.split("page=")[1];return i?`/${T}/${M}/${g}/page/${s}`:`/${T}/${M}/${g}`};Be(()=>{var i,s,f,B,C;return{...G($,[I.value,j.value,V.value]),title:(s=(i=r.value)==null?void 0:i.theCategory)!=null&&s.name?`${r.value.theCategory.name} - ${(f=d.value)==null?void 0:f.name} Products`:"Products",link:[...(B=r.value)!=null&&B.prev_page_url?[{rel:"prev",href:z(r.value.prev_page_url)}]:[],...(C=r.value)!=null&&C.next_page_url?[{rel:"next",href:z(r.value.next_page_url)}]:[]]}}),Pe(y(x.value,$));const W=async(i,s)=>{var f,B;if((B=(f=r.value)==null?void 0:f.theCategory)!=null&&B.id){n.setIsFilterLoading(!0),console.log("Filtering",i,s,"filtering started",n.isFilterLoading);try{const C=r.value.theCategory.id;i==="category"?n.getActiveCategoryFilters(C).includes(s)?n.removeCategoryFilter(C,s):n.addCategoryFilter(C,s):n.getActiveBrandFilters(C).includes(s)?n.removeBrandFilter(C,s):n.addBrandFilter(C,s),await n.applyFilters(C,N,z),await m()}finally{n.setIsFilterLoading(!1)}}},me=i=>W("category",i),pe=i=>W("brand",i),he=async()=>{n.setIsFilterLoading(!0);try{n.resetFilters(),await n.applyFilters(u.value,N,z),await m()}finally{n.setIsFilterLoading(!1)}};return(i,s)=>{var J,K,Q;const f=ge,B=_e,C=ve;return p(),h("main",Ne,[e("nav",Te,[e("div",Me,[e("ol",Ee,[e("li",je,[w(f,{to:"/"},{default:L(()=>s[2]||(s[2]=[P("HOME")])),_:1})]),e("li",ze,[w(f,{to:`/${(J=d.value)==null?void 0:J.slug}`},{default:L(()=>{var O;return[P(S((O=d.value)==null?void 0:O.name.toUpperCase()),1)]}),_:1},8,["to"])]),e("li",He,S((Q=(K=c(r))==null?void 0:K.theCategory)==null?void 0:Q.name),1)])])]),e("div",Ie,[e("div",Ve,[w(C,null,{default:L(()=>{var O,X,Y,D,ee,te,se,oe,ae;return[c(b)=="pending"&&!c(n).isFilterLoading?(p(),h("div",qe,[e("div",Re,[(p(),h(A,null,E(12,a=>e("div",{key:a,class:"col-6 col-md-3 col-lg-2 col-xl-2"},s[3]||(s[3]=[e("div",{class:"product product-7 text-center"},[e("div",{class:"product-media shimmer"},[e("div",{class:"product-image-shimmer"})]),e("div",{class:"product-body"},[e("div",{class:"product-cat"},[e("div",{class:"shimmer brand-shimmer"})]),e("div",{class:"product-title"},[e("div",{class:"shimmer title-shimmer"})])])],-1)]))),64))])])):ne("",!0),c(k)!=null||!((O=d.value)!=null&&O.active)?(p(),h("div",Ue,[s[8]||(s[8]=e("i",{class:"icon-exclamation-circle text-danger mb-4",style:{"font-size":"3rem"}},null,-1)),s[9]||(s[9]=e("h2",{class:"error-title mb-3"},"No Products Found",-1)),s[10]||(s[10]=e("p",{class:"error-message text-muted mb-4"}," We couldn't find any products in this category. This might be because: ",-1)),e("ul",Ze,[s[4]||(s[4]=e("li",null,"The selected filters might be too restrictive",-1)),s[5]||(s[5]=e("li",null,"The category might be temporarily empty",-1)),s[6]||(s[6]=e("li",null,"New products might be coming soon",-1)),e("li",null,S((X=d.value)==null?void 0:X.active),1)]),e("div",Ge,[e("button",{class:"btn btn-primary me-3",onClick:s[0]||(s[0]=()=>c(m)())}," Try Again "),w(f,{to:"/",class:"btn btn-outline-primary"},{default:L(()=>s[7]||(s[7]=[P(" Browse All Products ")])),_:1})])])):(p(),h("div",We,[e("div",Je,[e("div",null,[e("div",Ke,[e("div",Qe,[e("div",Xe,[s[11]||(s[11]=P(" Showing ")),e("span",null,S((Y=c(r))==null?void 0:Y.perPage)+" of "+S((D=c(r))==null?void 0:D.total),1),s[12]||(s[12]=P(" Products "))])]),e("div",Ye,[e("div",De,[s[14]||(s[14]=e("label",{for:"sortby"},"Sort by:",-1)),e("div",et,[we(e("select",{id:"sortby","onUpdate:modelValue":s[1]||(s[1]=a=>c(n).selectedSortOption=a),name:"sortby",class:"form-control"},s[13]||(s[13]=[e("option",{value:""},"Default",-1),e("option",{value:"name_asc"},"Name A - Z",-1),e("option",{value:"name_desc"},"Name Z - A",-1),e("option",{value:"created_at_asc"},"Latest First",-1),e("option",{value:"created_at_desc"}," Oldest First ",-1)]),512),[[Le,c(n).selectedSortOption]])])])])]),e("div",tt,[e("div",st,[(p(!0),h(A,null,E((ee=c(r))==null?void 0:ee.products,a=>(p(),h("div",{key:a.id,class:"col-6 col-md-3 col-lg-2 col-xl-2"},[e("div",ot,[e("figure",at,[w(f,{to:("getProductLink"in i?i.getProductLink:c(q))(a)},{default:L(()=>[w(B,{src:("assetsSync"in i?i.assetsSync:c(de))(a.main_image_path),alt:a==null?void 0:a.name,format:"webp",quality:"80",loading:"lazy",class:"w-full h-auto object-cover product-image"},null,8,["src","alt"])]),_:2},1032,["to"]),e("div",it,[e("button",{type:"button",class:"btn-product btn-cart",onClick:F=>("addToCart"in i?i.addToCart:c($e))(a)},s[15]||(s[15]=[e("span",null,"Add to Cart",-1)]),8,rt)])]),e("div",nt,[e("div",lt,[w(f,{to:("getProductLink"in i?i.getProductLink:c(q))(a)},{default:L(()=>{var F;return[P(S((F=a.product_brand)==null?void 0:F.name),1)]}),_:2},1032,["to"])]),e("h3",ct,[w(f,{to:("getProductLink"in i?i.getProductLink:c(q))(a)},{default:L(()=>[P(S(a==null?void 0:a.name),1)]),_:2},1032,["to"])])])])]))),128))])]),e("nav",dt,[e("ul",ut,[(p(!0),h(A,null,E((te=c(r))==null?void 0:te.links,a=>(p(),h("li",{key:a,class:le(["page-item",{active:a==null?void 0:a.active}])},[w(f,{class:"page-link",to:z(a==null?void 0:a.url)},{default:L(()=>[e("span",{innerHTML:a==null?void 0:a.label},null,8,mt)]),_:2},1032,["to"])],2))),128))])])])]),e("aside",pt,[e("div",ht,[e("div",{class:"widget widget-clean"},[s[16]||(s[16]=e("label",null,"Filters:",-1)),e("button",{class:"btn btn-primary btn-sm sidebar-filter-clear",onClick:he}," Clean All ")]),(se=c(r))!=null&&se.categories.length?(p(),h("div",gt,[s[17]||(s[17]=e("h3",{class:"widget-title"},[e("a",{"data-toggle":"collapse",href:"#widget-1",role:"button","aria-expanded":"true","aria-controls":"widget-1"}," Category ")],-1)),e("div",_t,[e("div",vt,[e("div",bt,[(p(!0),h(A,null,E((oe=c(r))==null?void 0:oe.categories,a=>{var F;return p(),h("div",{key:a.id,class:le(["filter-item",{"is-loading":c(n).isFilterLoading}])},[e("div",ft,[e("input",{id:"cat-"+a.id,type:"checkbox",class:"custom-control-input",checked:(F=c(n).checkedCategories[u.value])==null?void 0:F.includes(a.id),value:a.id,disabled:c(n).isFilterLoading,onChange:Z=>me(a.id)},null,40,yt),e("label",{class:"custom-control-label",for:"cat-"+a.id},S(a==null?void 0:a.name),9,kt),e("span",Ct,[c(n).isFilterLoading?(p(),h("span",St)):(p(),h(A,{key:0},[P(S(a.category_products_count),1)],64))])])],2)}),128))])])])])):ne("",!0),e("div",Ft,[s[18]||(s[18]=e("h3",{class:"widget-title"},[e("a",{href:"#widget-4",role:"button","aria-expanded":"true","aria-controls":"widget-4"}," Brand ")],-1)),e("div",wt,[e("div",Lt,[e("div",$t,[(p(!0),h(A,null,E((ae=c(r))==null?void 0:ae.brands,a=>{var F,Z,ie;return p(),h("div",{key:a.id,class:"filter-item"},[e("div",Pt,[e("input",{id:"brand-"+a.product_brand.id,type:"checkbox",class:"custom-control-input",checked:(F=c(n).checkedBrands[u.value])==null?void 0:F.includes(a.product_brand.id),value:a.product_brand.id,onChange:Nt=>pe(a.product_brand.id)},null,40,xt),e("label",{class:"custom-control-label",for:"brand-"+((Z=a.product_brand)==null?void 0:Z.id)},S((ie=a.product_brand)==null?void 0:ie.name),9,Bt)])])}),128))])])])])])])]))]}),fallback:L(()=>[e("div",Ot,[e("div",At,[(p(),h(A,null,E(12,O=>e("div",{key:O,class:"col-6 col-md-3 col-lg-2 col-xl-2"},s[19]||(s[19]=[e("div",{class:"product product-7 text-center"},[e("div",{class:"product-media shimmer"},[e("div",{class:"product-image-shimmer"})]),e("div",{class:"product-body"},[e("div",{class:"product-cat"},[e("div",{class:"shimmer brand-shimmer"})]),e("div",{class:"product-title"},[e("div",{class:"shimmer title-shimmer"})])])],-1)]))),64))])])]),_:1})])])])}}});export{qt as default};
